Algorithm and utility function implementations.
